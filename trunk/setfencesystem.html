<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="shortcut icon" href="./favicon.ico" />
    <title>loading...</title>
    <link rel="stylesheet" href="dist/styles/iview.css">
    <link rel="stylesheet" href="./maptalks/maptalks.css">
    <style>
        html,
        body,
        #container {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }
        
        #bmap {
            position: absolute;
            top: 0;
            left: 400px;
            bottom: 0;
            right: 0;
        }
        
        #controller {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 400px;
            border-right: 1px solid #A4D4F5;
            padding: 10px;
            box-sizing: border-box;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        #controller .controller-inner {
            width: 100%;
            height: 100%;
            background: #ffffff;
            position: relative;
            overflow-x: hidden;
        }
        
        .el-zoom-in-bottom-enter-active,
        .el-zoom-in-bottom-leave-active {
            opacity: 1;
            -webkit-transform: scaleY(1);
            transform: scaleY(1);
            -webkit-transition: opacity .3s cubic-bezier(.23, 1, .32, 1), -webkit-transform .3s cubic-bezier(.23, 1, .32, 1);
            transition: opacity .3s cubic-bezier(.23, 1, .32, 1), -webkit-transform .3s cubic-bezier(.23, 1, .32, 1);
            transition: transform .3s cubic-bezier(.23, 1, .32, 1), opacity .3s cubic-bezier(.23, 1, .32, 1);
            transition: transform .3s cubic-bezier(.23, 1, .32, 1), opacity .3s cubic-bezier(.23, 1, .32, 1), -webkit-transform .3s cubic-bezier(.23, 1, .32, 1);
            -webkit-transform-origin: center bottom;
            transform-origin: center bottom;
        }
        
        .el-zoom-in-bottom-enter,
        .el-zoom-in-bottom-leave-active {
            opacity: 0;
            -webkit-transform: scaleY(0);
            transform: scaleY(0)
        }
        
        .el-zoom-in-top-enter-active,
        .el-zoom-in-top-leave-active {
            transition: transform .3s cubic-bezier(.23, 1, .32, 1) .1s, opacity .3s cubic-bezier(.23, 1, .32, 1) .1s
        }
        
        .el-zoom-in-top-enter-active,
        .el-zoom-in-top-leave-active {
            opacity: 1;
            -ms-transform: scaleY(1);
            transform: scaleY(1);
            -ms-transform-origin: center top;
            transform-origin: center top
        }
        
        .el-zoom-in-top-enter,
        .el-zoom-in-top-leave-active {
            opacity: 0;
            -ms-transform: scaleY(0);
            transform: scaleY(0)
        }
        
        #container .area-ctrl {
            position: absolute;
            width: 400px;
            top: 10px;
            left: 410px;
            border: 1px solid #A4D4F5;
            background-color: #ffffff;
            border-radius: 5px;
        }
        
        .search-box {
            width: 100px;
            height: 41px;
        }
        
        .tree-box {
            position: absolute;
            right: 0;
            left: 0;
            bottom: 0;
            top: 82px;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        #container .ivu-btn .ivu-icon,
        #container .ivu-input-wrapper .ivu-icon {
            margin-top: 0px;
        }
        
        #container .ivu-select-arrow {
            margin-top: -7px important;
        }
        
        .selectTreeClass {
            background: #DEE1E6;
        }
        
        div.selected-map-wrap {
            height: 32px;
            width: 90px;
            background-color: #fff;
            cursor: pointer;
        }
        
        div.selected-map-inner {
            line-height: 30px;
            border: 1px solid #AEBAC5;
            height: 32px;
            position: relative;
            padding: 0 11px;
            overflow: hidden;
        }
        
        div.selected-map-list {
            position: absolute;
            top: 32px;
            left: 0px;
            right: 0px;
            background-color: #fff;
            border-left: 1px solid #AEBAC5;
            border-right: 1px solid #AEBAC5;
            border-bottom: 1px solid #AEBAC5;
            z-index: 99;
        }
        
        div.selected-map-list>div {
            padding: 0 11px;
            height: 30px;
            line-height: 30px;
        }
        
        div.selected-map-list>div:hover {
            background-color: #FCF0C0;
        }
        
        div.selected-map-list>div.actived {
            background-color: #FCF0C0;
        }
        
        div.map-selector-popup {
            position: absolute;
            right: 90px;
            padding: 5px 0px 5px 5px;
            box-shadow: 0 0 5px 0 rgb(0 0 0 / 10%);
            background-color: #fff;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
        }
        
        .MapSelector_item_193IR {
            height: 50px;
            width: 50px;
            border: 1px solid;
            cursor: pointer;
            position: relative;
            margin-right: 5px;
        }
        
        .satellite-map {
            background: url(./images/model-satel.png) no-repeat;
            background-position: 50%;
        }
        
        .normal-map {
            background: url(./images/model-map.png) no-repeat;
            background-position: 50%;
        }
        
        .map_icon_traffic_off {
            background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAbCAIAAADganh7AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGzSURBVHjazJXfS8JQFMfvve6Hbo6paWJqBaVED6nRa0LRP9A/Wv9AINirmAaRaRFiWZA1dTl1CreHxVpzd22i0Hna3T3n7O57PvcciDEGizYElmCU/bYyUm+br53+QOorCMGgwIUEbncz5mNpmyhI+v3xZFq4qrc7PcvdtbB4lEuzNOUiaeute1Gq2csNITw52ElGAk41LVYbfxYQY1ysNlxoOlanxmVQ4PbTSQBAud6SZIXk9ispxvj64Vl/tbcVN2U8PcxozxvR0Fmx0v0cGs9rioUQIk0dliFWUzujbtntBMmTZWgI4Y+mydUAkWTklGU9yXcA72XjEeu8pVrTuKzcP1m6xSMB3suaCxUW/SLve3nvAQCN3pKsnF9Ws6kEAKB81+oNhia0ggIXWxFpymNdfZryrEdDs6eQZKVQrhNoBbMhS7n7S2so9pzawE/ilNI5HasTy8/awz8np87hd8GpQ/jdcVqqNY39bQb+uTi1h9+SU4ogOWVsayT4WYZywWk+k9LqaEc4gvlMasEz6jiXZlzNKN0GI/Xmsf0hK115iBAU/T5tmvJeZp5p+u/u/tcAV7jFUh06f50AAAAASUVORK5CYII=) no-repeat;
            background-position: center 3px;
        }
        
        .map_icon_traffic_on {
            background: url(data:image/png;base64,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) no-repeat;
            background-position: center 3px;
        }
        
        .map_icon_xiansu_off {
            background: url(data:image/png;base64,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) no-repeat;
            background-position: center 4px;
        }
        
        .map_icon_xiansu_on {
            background: url(data:image/png;base64,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) no-repeat;
            background-position: center 4px;
        }
        
        .map_selector_icon_text {
            position: absolute;
            bottom: 1px;
            left: 1px;
            right: 1px;
            height: 18px;
            line-height: 18px;
            text-align: center;
            font-size: 12px;
        }
        
        .no_selected_icon {
            background-color: rgba(255, 255, 255, 0.7);
        }
        
        .selected_icon {
            background-color: rgba(64, 150, 209, 0.9);
            color: rgb(255, 255, 255);
        }
        
        div.maptalks-attribution {
            display: none;
        }
        
        [v-cloak] {
            display: none;
        }
    </style>
</head>

<body>
    <div id="container" v-cloak>
        <div id="controller">
            <div class="controller-inner">
                <div style="height:41px">
                    <Row>
                        <i-col :span="6" style="text-align:center;">
                            <i-button style="width:80px;" @click="drawCircular" icon="md-add">{{isZh?"圆":"Circle"}}</i-button>
                        </i-col>
                        <i-col :span="6" style="text-align:center;">
                            <i-button style="width:80px;" @click="drawPolygon" icon="md-add">{{isZh?"多边形":"Polygon"}}</i-button>
                        </i-col>
                        <i-col :span="6" style="text-align:center;">
                            <i-button style="width:80px;" @click="addRoutePlanningTip" icon="md-add">{{isZh?"路线":"Route"}}</i-button>
                        </i-col>
                        <i-col :span="6" style="text-align:center;">
                            <i-button style="width:80px;" icon="md-add" @click="openClassModal">{{isZh?"路线":"Classify"}}</i-button>
                        </i-col>
                    </Row>
                </div>
                <div class="search-box" style="width:100%">
                    <Row style="width:100%">
                        <i-col :span="24">
                            <i-input style="width:100%;" v-model="searchValue" suffix="ios-search" :placeholder="isZh?'搜索':'Search'"></i-input>
                        </i-col>
                    </Row>
                </div>
                <div class="tree-box">
                    <Tree :data="treeData" show-checkbox @on-check-change="onCheckChange"></Tree>
                </div>
            </div>
        </div>
        <div id="bmap"></div>
        <div style="position: absolute; right:10px;top:10px;">
            <div>
                <selected-map @select-map="onSelectMap" @switch-traffic="onSwitchTraffic"></selected-map>
            </div>
        </div>
        <transition name="el-zoom-in-top">
            <div class="area-ctrl" v-show="isCircular">
                <Row v-if="isZh">
                    <i-col :span="24" style="padding:10px;text-align:center;">
                        <h3>{{isEdit?'编辑':'添加'}}圆 - 半径:{{radius}}米</h3>
                    </i-col>
                </Row>
                <Row v-else>
                    <i-col :span="24" style="padding:10px;text-align:center;">
                        <h3>{{isEdit?'Edit':'Add'}}Circle - radius:{{radius}}m</h3>
                    </i-col>
                </Row>
            </div>
        </transition>

        <transition name="el-zoom-in-top">
            <div v-if="isZh" class="area-ctrl" v-show="isPolygon">
                <Row>
                    <i-col :span="24" style="padding:10px;text-align:center;">
                        <h3>添加多边形</h3>
                    </i-col>
                </Row>
                <Row>
                    <i-col :span="22" offset="2" style="padding:10px 0 10px 0;">
                        1 、 把鼠标移到 地图上单击开始绘制，双击结束绘制
                    </i-col>
                </Row>
            </div>
            <div v-else class="area-ctrl" v-show="isPolygon">
                <Row>
                    <i-col :span="24" style="padding:10px;text-align:center;">
                        <h3>Add Polygon</h3>
                    </i-col>
                </Row>
                <Row>
                    <i-col :span="22" offset="2" style="padding:10px 0 10px 0;">
                        1 、 Move the mouse to the map, click to start drawing, double-click to end drawing
                    </i-col>
                </Row>
            </div>
        </transition>

        <transition name="el-zoom-in-top">
            <div class="area-ctrl" v-show="isRoutePlanning">
                <Row>
                    <i-col v-if="isZh" :span="24" style="padding:10px;text-align:center;">
                        <h3>{{ isEdit ? "编辑路线":"添加路线" }}</h3>
                    </i-col>
                    <i-col v-else :span="24" style="padding:10px;text-align:center;">
                        <h3>{{ isEdit ? "Edit line":"Add line" }}</h3>
                    </i-col>
                </Row>
                <Row v-show="!isEdit">
                    <i-col v-if="isZh" :span="18" offset="2" style="padding:10px 0 10px 0;">
                        1 、 请在地图上点击选择起止点,绘制线路
                    </i-col>
                    <i-col v-else :span="18" offset="2" style="padding:10px 0 10px 0;">
                        1 、 Please click on the map to select the starting and ending points and draw the route
                    </i-col>
                    <i-col span="4" style="text-align: center;line-height: 38px;">
                        <i-button size="small" type="error" @click="queryRoutePlanning">{{isZh ? "结束" : "End"}}</i-button>
                    </i-col>
                </Row>
                <Row style="padding: 10px">
                    <i-col :span="6" style="text-align:right;line-height:32px;">
                        {{isZh ? '围栏名称' : 'Fence name'}}:
                    </i-col>
                    <i-col :span="16">
                        <i-input v-model.trim="geoName"></i-input>
                    </i-col>
                </Row>
                <Row style="padding: 10px" v-if="!isEdit">
                    <i-col :span="6" style="text-align:right;line-height:32px;">
                        {{isZh ? '选择分类' : 'Classify'}}:
                    </i-col>
                    <i-col :span="16">
                        <i-select v-model="classId" style="width: 100%;">
                            <i-option :value="item.value" v-for="item in selectTypeList" :key="item.categoryid">{{item.label}}</i-option>
                        </i-select>
                    </i-col>
                </Row>
                <Row style="padding: 10px">
                    <i-col :span="6" style="text-align:right;line-height:32px;">
                        {{isZh ? '偏离距离' : 'Deviation'}}:
                    </i-col>
                    <i-col :span="16">
                        <input-number v-model.number="distance5" :min="0" style="width: 100%;"></input-number>
                    </i-col>
                    <i-col :span="2" style="line-height:32px;">
                        {{isZh ? '米' : 'm'}}
                    </i-col>
                </Row>
                <Row style="padding: 10px">
                    <i-col :span="6" style="text-align:right;line-height:32px;">
                        {{isZh ? '报警类型' : 'Alarm Type'}}:
                    </i-col>
                    <i-col :span="16">
                        <i-select v-model="alarmtype5">
                            <i-option value="1">{{isZh ? '偏离线路持续报警' : 'Deviation continuous alarm'}}</i-option>
                            <i-option value="2">{{isZh ? '驶入线路持续报警' : 'Drive in continuous alarm'}}</i-option>
                            <i-option value="3">{{isZh ? '偏离线路报警一次' : 'Deviation alarm once'}}</i-option>
                            <i-option value="4">{{isZh ? '驶入线路报警一次' : 'Drive in the alarm once'}}</i-option>
                        </i-select>
                    </i-col>
                </Row>
                <Row style="text-align:center;padding-bottom: 20px">
                    <i-col :span="24">
                        <i-button style="width:80%;" @click="addRoutePlanning">{{isZh ? '确定' : 'confirm'}}</i-button>
                    </i-col>
                </Row>
            </div>
        </transition>

        <Modal v-model="addClassModal" width="400" :title="isZh?'添加分类':'Add Classify'">
            <Row style="padding: 10px">
                <i-col :span="6" style="text-align:center;line-height:32px;">
                    {{isZh ? '类型名称' : 'Classify Name'}}:
                </i-col>
                <i-col :span="16">
                    <i-input v-model.trim="typeName"></i-input>
                </i-col>
            </Row>
            <div slot="footer" style="text-align:center;">
                <i-button style="width:80%;" @click="handleAddType">{{isZh ? '确定' : 'confirm'}}</i-button>
            </div>
        </Modal>

        <Modal v-model="addPolygonModal" width="400" :title="isZh?'添加围栏':'Add Fence'" :mask-closable="false">
            <Row style="padding: 10px">
                <i-col :span="6" style="text-align:center;line-height:32px;">
                    {{isZh ? '围栏名称' : 'Fence Name'}}:
                </i-col>
                <i-col :span="16">
                    <i-input v-model.trim="geoName"></i-input>
                </i-col>
            </Row>
            <Row style="padding: 10px">
                <i-col :span="6" style="text-align:center;line-height:32px;">
                    {{isZh ? '选择类型' : 'Selected Type'}}:
                </i-col>
                <i-col :span="16">
                    <i-select v-model="classId" style="width: 100%;">
                        <i-option :value="item.value" v-for="item in selectTypeList" :key="item.categoryid">{{item.label}}</i-option>
                    </i-select>
                </i-col>
            </Row>
            <div slot="footer" style="text-align:center;">
                <i-button style="width:80%;" @click="handleAddPolygon">{{isZh ? '确定' : 'confirm'}}</i-button>
            </div>
        </Modal>
    </div>


    <script type="text/x-template" id="selected-map-template">
        <div class="selected-map-wrap" v-click-outside.capture="onClickOutside">
            <div class="selected-map-inner" @click="isShowMapList=true">
                {{mapTypeStr}}
                <Icon type="ios-arrow-down" />
            </div>
            <div class="selected-map-list" v-show="isShowMapList">
                <div v-for="(item,index) in mapSelectorList" :data-index="index" :class="{actived:mapType==item.value}" :key="index" @click="selectedMap">{{item.label}}</div>
            </div>
            <div class="map-selector-popup" v-show="isShowMapList" :style="mapSelectorPopupSty">
                <div v-if="false" class="MapSelector_item_193IR" :class="{'map_icon_xiansu_off':!isShowXianSu,'map_icon_xiansu_on':isShowXianSu}" style="width:35px" @click="isShowXianSu=!isShowXianSu">
                    <div class="map_selector_icon_text no_selected_icon">{{speed}}</div>
                </div>
                <div class="MapSelector_item_193IR" :class="{'map_icon_traffic_off':!isShowTraffic,'map_icon_traffic_on':isShowTraffic}" style="width:35px" @click="isShowTraffic=!isShowTraffic">
                    <div class="map_selector_icon_text no_selected_icon">{{traffic}}</div>
                </div>
                <div class="MapSelector_item_193IR normal-map" @click="isSatelliteMap=false">
                    <div class="map_selector_icon_text" :class="{'selected_icon':!isSatelliteMap,'no_selected_icon':isSatelliteMap}">{{map}}</div>
                </div>
                <div class="MapSelector_item_193IR satellite-map" @click="isSatelliteMap=true">
                    <div class="map_selector_icon_text" :class="{'selected_icon':isSatelliteMap,'no_selected_icon':!isSatelliteMap}">{{satellite}}</div>
                </div>
            </div>
        </div>
    </script>


    <script src="js/polyfill.min.js"></script>
    <script src="dist/vue.min.js"></script>
    <script src="dist/iview.min.js"></script>
    <script src="js/zh-CN.js"></script>
    <script src="js/en-US.js"></script>
    <script src="js/gps51-jquery.js"></script>
    <script src="js/config.js"></script>
    <script src="js/v-click-outside-x.js"></script>
    <script src="js/transformlatlon.js"></script>
    <script src="js/dateformat.js"></script>
    <script src="js/util.js"></script>
    <script src="./maptalks/maptalks.min.js"></script>

    <script>
        var isZh = utils.locale === 'zh';
        document.title = isZh ? '系统围栏' : 'System Fence';
        iview.lang(isZh ? 'zh-CN' : 'en-US');
        var token = utils.getParameterByName("token");
        var map = null;
        var vRoot = null;
        var rowData = null;
        var isMove = true;
        var mapType = utils.getMapType();
        var points1List = [];
        var points2List = [];
        var symbol = {
            'lineColor': '#e4393c',
            'lineWidth': 2,
            'polygonFill': 'rgb(135,196,240)',
            'polygonOpacity': 0
        };



        function treeItemRender(h, params) {
            var root = params.root,
                node = params.node,
                data = params.data;
            return h('span', {
                style: {
                    display: 'inline-block',
                    width: '343px'
                },
            }, [
                h('span', [
                    h('span', {
                        style: {
                            width: '271px',
                            lineHeight: '23px',
                            display: 'inline-block',
                        }
                    }, data.title)
                ]),

                h('Icon', {
                    props: {
                        size: 18,
                        type: "md-close",
                    },
                    style: {
                        // width: '54px'
                        color: "#DEE1E6",
                        border: "1px solid #DEE1E6",
                        borderRadius: "50%",
                    },
                    on: {
                        click: function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            var content = "";
                            if (data.children) {
                                content = isZh ? "确定要删除分类吗" : "Are you sure you want to delete the category?";
                            } else {
                                content = isZh ? "确定要删除围栏吗" : "Are you sure you want to delete the fence?";
                            }
                            vRoot.$Modal.confirm({
                                title: isZh ? "温馨提示" : "Tips",
                                content: content,
                                onOk: function() {
                                    if (data.children) {
                                        vRoot.deleteTreeItem(data);
                                    } else {
                                        vRoot.deleteTreeChildren(data);
                                    }
                                }
                            })
                            return false;
                        }
                    }
                }, '')
            ]);
        }

        function treeChilrenRender(h, params) {
            var root = params.root,
                node = params.node,
                data = params.data;
            return h('span', {
                style: {
                    display: 'inline-block',
                    width: '343px',
                    height: '23.5px'
                },
                on: {
                    click: function(e) {}
                }
            }, [
                h('span', {
                        style: {
                            lineHeight: '24px',
                            width: '253px',
                            display: 'inline-block',
                        },
                        attrs: {
                            class: 'show'
                        },
                        on: {
                            click: function(e) {
                                // $(".show").removeClass("selectTreeClass");
                                // $(e.target).addClass("selectTreeClass");
                                // vRoot.cancelSelected();
                                // rowData = data;
                                // if (data.children) return;
                                // vRoot.isEdit = true;

                                // switch (data.type) {
                                //     case 1:

                                //         break;
                                //     case 2:
                                //         vRoot.isCircular = false;
                                //         // vRoot.redrawPolygon(data);
                                //         break;
                                // }
                            }

                        }
                    },
                    data.title),
                h('Button', {
                    props: {
                        type: 'info',
                        size: 'small',
                        disabled: data.type != 5,
                    },
                    style: {
                        marginRight: '5px',
                        marginTop: '-2px',
                    },
                    on: {
                        click: function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            rowData = data;
                            vRoot.isRoutePlanning = true;
                            vRoot.isCircular = false;
                            vRoot.modal = false;
                            vRoot.isPolygon = false;
                            vRoot.isEdit = true;
                            vRoot.geoName = data.name;
                            vRoot.distance5 = data.distance5;
                            vRoot.alarmtype5 = String(data.alarmtype5);
                        }
                    }
                }, isZh ? "编辑" : "Edit"),
                h('Icon', {
                    props: {
                        size: 18,
                        type: "md-close",
                    },
                    style: {
                        border: "1px solid #DEE1E6",
                        borderRadius: "50%",
                        color: "#DEE1E6",
                        marginTop: "-1px"
                    },
                    on: {
                        click: function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            var content = "";
                            if (data.children) {
                                content = isZh ? "确定要删除分类吗" : "Are you sure you want to delete the category?";
                            } else {
                                content = isZh ? "确定要删除围栏吗" : "Are you sure you want to delete the fence?";
                            }
                            vRoot.$Modal.confirm({
                                title: isZh ? "温馨提示" : "Tips",
                                content: content,
                                onOk: function() {
                                    if (data.children) {
                                        vRoot.deleteTreeItem(data);
                                    } else {
                                        vRoot.deleteTreeChildren(data);
                                    }
                                }
                            })
                            return false;
                        }
                    }
                }, ''),
            ]);
        }
        (function() {


            Vue.component('selected-map', {
                data: function() {
                    return {
                        isShowMapList: false, //是否显示选择框
                        isSatelliteMap: false, //是否卫星地图
                        isShowXianSu: false,
                        isShowTraffic: false,
                        mapSelectorList: [{
                            label: isZh ? "百度地图" : "BaiduMap",
                            value: "bMap"
                        }, {
                            label: isZh ? "谷歌地图" : "GoogleMap",
                            value: "gMap"
                        }, {
                            label: isZh ? "高德地图" : "AMap",
                            value: "aMap"
                        }, {
                            label: isZh ? "国内谷歌" : "gChinaMap",
                            value: "gChinaMap"
                        }, ],
                        speed: isZh ? "限速" : "Speed",
                        traffic: isZh ? "路况" : "Traffic",
                        map: isZh ? "地图" : "Map",
                        satellite: isZh ? "卫星" : "Satellite",
                        currentMapIndex: 0,
                        mapType: mapType
                    }
                },
                methods: {
                    onClickOutside: function() {
                        this.isShowMapList = false;
                    },
                    selectedMap: function(e) {
                        var index = Number(e.target.dataset.index);
                        var item = this.mapSelectorList[index];
                        this.mapType = item.value;
                        mapType = item.value;
                        this.$emit('select-map', {
                            mapType: item.value,
                            xiansu: this.isShowXianSu,
                            traffic: this.isShowTraffic,
                            satelliteMap: this.isSatelliteMap
                        });
                        this.currentMapIndex = index;
                    },
                    getCurrentMapIndex: function() {
                        var index = 0;
                        for (var i = 0; i < this.mapSelectorList.length; i++) {
                            var item = this.mapSelectorList[i];
                            if (item.value == this.mapType) {
                                index = i;
                                break;
                            }
                        }
                        return index;
                    }
                },
                computed: {
                    mapTypeStr: function() {
                        var mapTypeStr = '';
                        for (var i = 0; i < this.mapSelectorList.length; i++) {
                            var item = this.mapSelectorList[i];
                            if (item.value == this.mapType) {
                                mapTypeStr = item.label;
                                break;
                            }
                        }
                        return mapTypeStr;
                    },
                    mapSelectorPopupSty: function() {
                        var top = 31;
                        var currentMapIndex = this.currentMapIndex;
                        var maxCurrentIndex = this.mapSelectorList.length - 1;

                        top = top * (currentMapIndex + 1);

                        if (currentMapIndex == maxCurrentIndex) {
                            top -= 31;
                        }

                        return {
                            top: top + 'px'
                        }
                    }
                },
                watch: {
                    isSatelliteMap: function() {
                        this.$emit('select-map', {
                            mapType: this.mapType,
                            xiansu: this.isShowXianSu,
                            traffic: this.isShowTraffic,
                            satelliteMap: this.isSatelliteMap
                        });
                    },
                    isShowXianSu: function(newVal) {
                        this.$emit('switch-xiansu', newVal);
                    },
                    isShowTraffic: function(newVal) {
                        this.$emit('switch-traffic', newVal);
                    },
                },
                mounted: function() {
                    this.currentMapIndex = this.getCurrentMapIndex();
                },
                template: document.getElementById('selected-map-template').innerHTML
            })


            vRoot = new Vue({
                el: "#container",
                data: {
                    searchValue: "",
                    isEdit: false,
                    map: null,
                    typeName: '',
                    classId: "",
                    geoName: "",
                    distance5: 20,
                    alarmtype5: "1",
                    addClassModal: false,
                    addPolygonModal: false,
                    isCircular: false,
                    isPolygon: false,
                    isRoutePlanning: false,
                    radius: 2000,
                    min: 200,
                    max: 100000,
                    modal: false,
                    type: null, // 1 是圈 2是多边形 3是行政区域'
                    mapCenterPoint: null,
                    treeData: [],
                    originalData: [],
                    mapType: mapType,
                },
                methods: {
                    addRoutePlanning: function() {
                        var me = this;
                        if (me.isEdit) {
                            var url = myUrls.editGeoSystemRecord();
                            var data = deepClone(rowData);
                            data.name = this.geoName;
                            data.distance5 = this.distance5;
                            data.alarmtype5 = this.alarmtype5;
                            utils.sendAjax(url, data, function(resp) {
                                if (resp.status === 0) {
                                    rowData.name = data.name;
                                    rowData.title = data.name;
                                    rowData.distance5 = data.distance5;
                                    rowData.alarmtype5 = data.alarmtype5;
                                    me.$Message.success(isZh ? "编辑成功" : "Edited successfully");
                                } else {
                                    me.$Message.error(isZh ? "编辑失败" : "Edited failed");
                                }
                            })
                        } else {
                            if (me.wgs84Points == null) {
                                me.$Message.error(isZh ? "查询路线还没返回" : "Added failed");
                                return;
                            }
                            if (this.classId == "") {
                                me.$Message.error(isZh ? "请选择分类" : "Please select category");
                                return;
                            }
                            var url = myUrls.addGeoSystemRecord();
                            var data = {
                                name: this.geoName,
                                categoryid: this.classId,
                                distance5: this.distance5,
                                alarmtype5: Number(this.alarmtype5),
                                type: 5,
                                totaldistance5: this.totalDistance,
                                totalduration5: this.totalDuration,
                                points2: JSON.stringify(this.wgs84Points),
                            }
                            utils.sendAjax(url, data, function(resp) {
                                if (resp.status === 0) {
                                    me.$Message.success(isZh ? "添加成功" : "Added successfully");
                                    me.originalData.forEach(function(item) {
                                        if (data.categoryid === item.categoryid) {
                                            resp.record.title = resp.record.name;
                                            resp.record.categoryid = data.categoryid;
                                            resp.record.render = treeChilrenRender;
                                            item.children.push(resp.record);
                                        }
                                    })
                                } else {
                                    me.$Message.error(isZh ? "添加失败" : "Added failed");
                                }
                            })
                        }
                    },
                    onSelectMap: function(item) {
                        this.mapType = item.mapType;
                        this.setMapType(item);
                    },
                    onSwitchTraffic: function(traffic) {
                        var isBMap = this.mapType == 'bMap';
                        if (traffic) {
                            if (isBMap) {
                                this.baiduTrafficLayer.show();
                            } else {
                                this.googleTrafficLayer.show();
                            }
                        } else {
                            if (isBMap) {
                                this.baiduTrafficLayer.hide();
                            } else {
                                this.googleTrafficLayer.hide();
                            }
                        }
                    },
                    setMapType: function(mapInfo) {
                        this.map.removeLayer('baiduText');
                        this.map.removeLayer('aliText');
                        var me = this;
                        var newMapType = mapInfo.mapType;
                        var satelliteMap = mapInfo.satelliteMap;

                        var traffic = mapInfo.traffic;
                        if (newMapType == 'bMap') {
                            me.map.setSpatialReference({
                                projection: 'baidu'
                            });
                            var baseOption = satelliteMap ? baiduSatelliteBaseOption : baiduNormaBaseOption;
                            var layer = new maptalks.TileLayer('base', baseOption)
                            me.map.setBaseLayer(layer);
                            if (satelliteMap) {
                                var textlayer = new maptalks.TileLayer('baiduText', baiduTextBaseOption)
                                me.map.addLayer(textlayer);
                            }

                        } else if (newMapType == 'gMap') {
                            var baseOption = satelliteMap ? googleSatelliteBaseOption : googleNormaBaseOption;
                            var layer = new maptalks.TileLayer('base', baseOption)
                            me.map.setSpatialReference({})
                            me.map.setBaseLayer(layer);
                        } else if (newMapType == 'aMap') {
                            var baseOption = satelliteMap ? aliSatelliteBaseOption : aliNormaBaseOption;
                            var layer = new maptalks.TileLayer('base', baseOption)
                            me.map.setSpatialReference({})
                            me.map.setBaseLayer(layer);
                            if (satelliteMap) {
                                var textlayer = new maptalks.TileLayer('aliText', aliTextBaseOption)
                                me.map.addLayer(textlayer);
                            }

                        } else if (newMapType == 'gChinaMap') {
                            var baseOption = satelliteMap ? googleChinaSatelliteBaseOption : googleChinaNormaBaseOption;
                            var layer = new maptalks.TileLayer('base', baseOption)
                            me.map.setSpatialReference({})
                            me.map.setBaseLayer(layer);
                        }

                        me.addTrafficLayer(traffic);
                    },
                    addTrafficLayer: function(traffic) {

                        if (this.baiduTrafficLayer == null) {
                            this.baiduTrafficLayer = new maptalks.TileLayer("baidutraffic", {

                                urlTemplate: function(x, y, z) {
                                    var domain = '';
                                    if (this.options && this.options['subdomains']) {
                                        var subdomains = this.options['subdomains'];
                                        if (isArrayHasData(subdomains)) {
                                            var length = subdomains.length;
                                            var s = (x + y) % length;
                                            if (s < 0) {
                                                s = 0;
                                            }
                                            domain = subdomains[s];
                                        }
                                    }
                                    var data = {
                                        'x': x,
                                        'y': y,
                                        'z': z,
                                        'domain': domain,
                                        'time': Date.now()
                                    };
                                    var URL_PATTERN = /\{ *([\w_]+) *\}/g;
                                    return baiduTrafficUrlTemplate.replace(URL_PATTERN, function(str, key) {
                                        var value = data[key];

                                        if (value === undefined) {
                                            throw new Error('No value provided for variable ' + str);

                                        } else if (typeof value === 'function') {
                                            value = value(data);
                                        }
                                        return value;
                                    });
                                }
                            });
                            this.map.addLayer(this.baiduTrafficLayer);
                            this.baiduTrafficLayer.hide();
                        }

                        if (this.googleTrafficLayer == null) {
                            this.googleTrafficLayer = new maptalks.TileLayer("googletraffic", {
                                urlTemplate: function(x, y, z) {

                                    y = Math.pow(2, z) - 1 - y;
                                    var domain = '';
                                    if (this.options && this.options['subdomains']) {
                                        var subdomains = this.options['subdomains'];
                                        if (isArrayHasData(subdomains)) {
                                            var length = subdomains.length;
                                            var s = (x + y) % length;
                                            if (s < 0) {
                                                s = 0;
                                            }
                                            domain = subdomains[s];
                                        }
                                    }
                                    var data = {
                                        'x': x,
                                        'y': y,
                                        'z': z,
                                        'domain': domain,
                                        'time': Date.now()
                                    };
                                    var URL_PATTERN = /\{ *([\w_]+) *\}/g;
                                    return googleTrafficUrlTemplate.replace(URL_PATTERN, function(str, key) {
                                        var value = data[key];

                                        if (value === undefined) {
                                            throw new Error('No value provided for variable ' + str);

                                        } else if (typeof value === 'function') {
                                            value = value(data);
                                        }
                                        return value;
                                    });
                                }
                            });
                            this.map.addLayer(this.googleTrafficLayer);
                            this.googleTrafficLayer.hide();
                        }

                        this.onSwitchTraffic(traffic);

                    },
                    initMap: function() {
                        var me = this;

                        me.lastMapType = this.mapType;

                        this.map = new maptalks.Map('bmap', {
                            center: [106, 36.11],
                            zoom: 5,
                            minZoom: 4,
                            maxZoom: 19,
                            scaleControl: true,
                            dragRotate: false,
                            dragPitch: false,
                        });

                        this.setMapType({
                            mapType: this.mapType,
                            traffic: false,
                            xiansu: false,
                            satelliteMap: false
                        });


                        me.isLoadRoutePlanning = false;
                        me.startCoordinate = null;
                        me.endCoordinate = null;
                        me.routePlanningCoordinates = [];
                        this.map.on('click', function(e) {
                            if (me.isRoutePlanning && me.isLoadRoutePlanning == false && me.isEdit == false) {
                                if (me.startCoordinate == null) {
                                    me.wgs84Points == null
                                    me.routePlanningCoordinates = [];
                                    me.routePlanningCoordinates.push(e.coordinate);
                                    me.polygonLayer.clear();
                                    me.startCoordinate = e.coordinate;
                                    me.startMarker = new maptalks.Marker(
                                        [e.coordinate.x, e.coordinate.y], {
                                            symbol: [{
                                                'markerFile': './images/map/marker_qidian.png',
                                                'markerWidth': 30,
                                                'markerHeight': 30,
                                                'markerRotation': 0,
                                                'markerDy': 0,
                                                'markerDx': 0,
                                            }, {
                                                'textFaceName': 'sans-serif',
                                                'textName': '起点',
                                                'textSize': 12,
                                                'textDy': 10,
                                                'textFill': '#ffffff',
                                                'textOpacity': 1,
                                                'textHaloFill': '#00A8D4',
                                                'textHaloRadius': 5,
                                                'textWrapWidth': null,
                                                'textWrapCharacter': '\n',
                                                'textLineSpacing': 0,
                                            }]
                                        }
                                    );
                                    me.startMarker.addTo(me.polygonLayer);
                                } else {
                                    me.endCoordinate = e.coordinate;
                                    me.routePlanningCoordinates.push(e.coordinate);
                                    me.endMarker = new maptalks.Marker(
                                        [e.coordinate.x, e.coordinate.y], {
                                            symbol: [{
                                                'markerFile': './images/stop_red_32.png',
                                                'markerWidth': 30,
                                                'markerHeight': 30,
                                                'markerRotation': 0,
                                                'markerDy': 0,
                                                'markerDx': 0,
                                            }, {
                                                'textFaceName': 'sans-serif',
                                                'textName': '经过',
                                                'textSize': 12,
                                                'textDy': 10,
                                                'textFill': '#ffffff',
                                                'textOpacity': 1,
                                                'textHaloFill': '#00A8D4',
                                                'textHaloRadius': 5,
                                                'textWrapWidth': null,
                                                'textWrapCharacter': '\n',
                                                'textLineSpacing': 0,
                                            }]
                                        }
                                    );
                                    me.endMarker.addTo(me.polygonLayer);
                                }
                            }
                        });


                        var customPosition = new maptalks.control.Zoom({
                            'position': {
                                'bottom': '10',
                                'right': '10'
                            },
                            'slider': false,
                            'zoomLevel': false
                        });
                        this.map.addControl(customPosition);



                        var layer = this.polygonLayer = new maptalks.VectorLayer('vector').addTo(this.map);

                        var drawTool = this.drawTool = new maptalks.DrawTool({
                            mode: 'Point',
                            symbol: symbol
                        }).addTo(this.map).disable();


                        this.drawTool.on('mousemove', function(param) {
                            if (me.isCircular) {
                                me.radius = param.geometry.getRadius().toFixed(2);
                            }
                        })

                        this.drawTool.on('drawend', function(param) {
                            var geometry = param.geometry;
                            var isBMap = me.mapType == 'bMap';
                            layer.addGeometry(param.geometry);
                            drawTool.disable();
                            me.addPolygonModal = true;
                            if (me.isCircular) {
                                var point = geometry.getCoordinates();
                                var lon_lat = [];
                                if (isBMap) {
                                    lon_lat = bd09towgs84(point.x, point.y);
                                } else {
                                    lon_lat = gcj02towgs84(point.x, point.y);
                                }
                                points1List = lon_lat;
                            } else {
                                var points = geometry.getCoordinates()[0];
                                var lon_lat_s = [];
                                if (isBMap) {
                                    lon_lat_s = bdPointsToWgs84s(points);
                                } else {
                                    lon_lat_s = googlePointsToWgs84s(points);
                                }

                                points2List = lon_lat_s;
                            }
                        });

                    },
                    setViewPortCenter: function(pointList) {
                        if (pointList.length == 1) {
                            this.map.setCenterAndZoom(pointList[0], 12)
                        } else if (pointList.length > 1) {
                            var polygon = new maptalks.Polygon(pointList);
                            this.map.fitExtent(polygon.getExtent(), 0);
                            polygon = null;
                        }

                    },
                    openClassModal: function() {
                        this.isPolygon = false;
                        this.isCircular = false;
                        this.addClassModal = true;
                        this.drawTool.disable();
                    },
                    queryRoutePlanning: function() {
                        var me = this;
                        if (me.routePlanningCoordinates.length > 1) {
                            me.isLoadRoutePlanning = true;
                            me.wgs84Points = null;
                            var isBMap = this.mapType == 'bMap';
                            var routePlanningCoordinates = null;

                            if (isBMap) {
                                routePlanningCoordinates = me.routePlanningCoordinates.map(function(item) {
                                    var point = bd09togcj02(item.x, item.y);
                                    return {
                                        x: Number(point[0].toFixed(6)),
                                        y: Number(point[1].toFixed(6)),
                                    }
                                });
                            } else {
                                routePlanningCoordinates = me.routePlanningCoordinates.map(function(item) {
                                    return {
                                        x: Number(item.x.toFixed(6)),
                                        y: Number(item.y.toFixed(6)),
                                    }
                                });

                            }
                            var startCoordinate = routePlanningCoordinates.shift();
                            var endCoordinate = routePlanningCoordinates.pop();


                            var url = 'https://restapi.amap.com/v3/direction/driving?origin=' + startCoordinate.x + ',' + startCoordinate.y + '&destination=' + endCoordinate.x + ',' + endCoordinate.y + '&output=json&key=7d965b1fc170725157ee74df02b7119a&platform=JS';

                            if (routePlanningCoordinates.length > 0) {
                                var waypoints = "";
                                var length = routePlanningCoordinates.length - 1;
                                routePlanningCoordinates.forEach(function(item, index) {
                                    if (length == index) {
                                        waypoints += item.x + "," + item.y;
                                    } else {
                                        waypoints += item.x + "," + item.y + ";";
                                    }
                                })
                                url = url + "&waypoints=" + waypoints;
                            }


                            $.ajax({
                                url: url,
                                type: 'get',
                                success: function(result) {
                                    me.isLoadRoutePlanning = false;
                                    if (result.status == 1) {
                                        var wgs84Points = me.convertAmapRouteJsonToPoints(result.route);
                                        var mapPoints = me.convertWgs84PointsToMapPoints(wgs84Points);
                                        me.wgs84Points = wgs84Points;

                                        new maptalks.LineString(
                                            mapPoints, {
                                                symbol: {
                                                    'lineColor': {
                                                        'type': 'linear',
                                                        'colorStops': [
                                                            [0.00, 'red'],
                                                            [1.00, 'red']
                                                        ]
                                                    },
                                                    'lineWidth': 4
                                                }
                                            }).addTo(me.polygonLayer);

                                        var paths = result.route.paths;
                                        var totalDistance = 0;
                                        var totalDuration = 0;
                                        paths.forEach(function(path) {
                                            totalDistance += Number(path.distance);
                                            totalDuration += Number(path.duration);
                                        });
                                        me.totalDistance = totalDistance;
                                        me.totalDuration = totalDuration;
                                        me.endMarker.setSymbol([{
                                            'markerFile': './images/map/marker_zhongdian.png',
                                            'markerWidth': 30,
                                            'markerHeight': 30,
                                            'markerRotation': 0,
                                            'markerDy': 0,
                                            'markerDx': 0,
                                        }, {
                                            'textFaceName': 'sans-serif',
                                            'textName': '总里程:' + (totalDistance / 1000).toFixed(2) + '公里,时长:' + me.timeStamp(totalDuration * 1000),
                                            'textSize': 12,
                                            'textDy': 10,
                                            'textFill': '#ffffff',
                                            'textOpacity': 1,
                                            'textHaloFill': '#00A8D4',
                                            'textHaloRadius': 5,
                                            'textWrapWidth': null,
                                            'textWrapCharacter': '\n',
                                            'textLineSpacing': 0,
                                        }]);
                                        me.geoName = '';
                                    } else {
                                        me.$Message.error(isZh ? "没有查询到路线" : "No route found");
                                        me.polygonLayer.clear();
                                        me.totalDistance = 0;
                                        me.totalDuration = 0;
                                        console.log("queryRoutePlanning from amap:", result);
                                    }
                                    me.startCoordinate = null;
                                    me.endCoordinate = null;
                                },
                                error: function(err) {
                                    me.$Message.error(isZh ? "查询路线失败" : "Failed to query route");
                                    me.polygonLayer.clear();
                                    me.isLoadRoutePlanning = false;
                                    me.startCoordinate = null;
                                    me.endCoordinate = null;
                                }
                            });
                        } else {
                            me.$Message.error(isZh ? '请最少添加2个坐标点' : 'Please add at least 2 coordinate points');
                        }

                    },
                    timeStamp: function(mss) {
                        var strTime = '';
                        var days = parseInt(mss / (1000 * 60 * 60 * 24));
                        var hours = parseInt((mss % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        var minutes = parseInt((mss % (1000 * 60 * 60)) / (1000 * 60));
                        var seconds = parseInt((mss % (1000 * 60)) / 1000);
                        if (days > 0) {
                            strTime = days ? (strTime += days + (isZh ? '天' : 'day')) : '';
                        } else {
                            hours ? (strTime += hours + (isZh ? '小时' : 'h')) : '';
                            minutes ? (strTime += minutes + (isZh ? '分' : 'm')) : '';
                            seconds ? (strTime += seconds + (isZh ? '秒' : 's')) : '';
                        }
                        return strTime == '' ? '0' + (isZh ? '分' : 'm') : strTime;
                    },
                    convertAmapRouteJsonToPoints: function(amapRoute) {
                        var points = [];
                        var totalStepsStr = "";
                        var paths = amapRoute.paths;
                        if (paths) {
                            var path = paths[0];
                            if (path) {
                                var steps = path.steps;
                                if (steps) {
                                    steps.forEach(function(stepStr) {
                                        totalStepsStr += stepStr.polyline + ";";
                                    })

                                }
                            }
                        }

                        if (totalStepsStr.length > 1) {
                            var splitedSteps = totalStepsStr.split(";");
                            splitedSteps.forEach(function(step) {
                                if (step.length > 0) {
                                    var onePoint = step.split(",");
                                    var x = onePoint[0];
                                    var y = onePoint[1];
                                    var wgs84Ponts = gcj02towgs84(Number(x), Number(y));
                                    points.push({
                                        x: Number(wgs84Ponts[0].toFixed(6)),
                                        y: Number(wgs84Ponts[1].toFixed(6)),
                                    })
                                }
                            })
                        }

                        return points;
                    },
                    convertWgs84PointsToMapPoints: function(wgs84Ponts) {
                        var isBMap = this.mapType == 'bMap';
                        var mapPonts = [];
                        wgs84Ponts.forEach(function(point) {
                            var point = utils.getCurrentMapCoordinate(isBMap, [point.x, point.y]);
                            mapPonts.push({
                                x: point[0],
                                y: point[1],
                            })
                        });
                        return mapPonts;
                    },
                    handleAddType: function() {
                        if (this.typeName) {
                            var url = myUrls.addGeoSystemCategory(),
                                me = this;
                            var data = {
                                name: this.typeName
                            };
                            utils.sendAjax(url, data, function(resp) {
                                if (resp.status === 0 && resp.record) {
                                    var record = resp.record;
                                    record.title = record.name,
                                        record.children = [];
                                    record.render = treeItemRender;
                                    me.originalData.push(record);
                                    me.treeData = me.originalData;
                                    me.$Message.success(isZh ? "添加成功" : "Added successfully");
                                    me.addClassModal = false;
                                    me.typeName = '';
                                } else {
                                    me.$Message.error(isZh ? "添加失败" : "Add failed");
                                }
                            });
                        } else {
                            this.$Message.error(isZh ? "请填写类型名称" : "Please fill in the type name");
                        }
                    },
                    searchChange: utils.debounce(function(vm, value) {
                        if (value) {
                            var filterData = [];
                            var originalData = deepClone(vm.originalData);
                            originalData.forEach(function(item) {
                                item.expand = true;
                                if (item.title.indexOf(value) != -1) {
                                    filterData.push(item);
                                } else {
                                    var children = []
                                    item.children.forEach(function(record) {
                                        if (record.title.indexOf(value) != -1) {
                                            children.push(record);
                                        }
                                    });
                                    if (children.length) {
                                        item.children = children;
                                        filterData.push(item);
                                    }
                                }
                            });
                            vm.treeData = filterData;
                        } else {
                            vm.treeData = vm.originalData;
                        }

                    }, 500),
                    deleteTreeItem: function(data) {
                        var url = myUrls.delGeoSystemCategory(),
                            me = this;
                        utils.sendAjax(url, {
                            categoryid: data.categoryid
                        }, function(resp) {
                            console.log('resp', resp)
                            if (resp.status === 0) {
                                var index = null;
                                me.cancelSelected();
                                me.originalData.forEach(function(item, idx) {
                                    if (item.categoryid === data.categoryid) {
                                        index = idx;
                                    }
                                });
                                me.originalData.splice(index, 1);
                                me.treeData = me.originalData;
                            } else if (resp.status === 1) {
                                me.$Message.error(isZh ? "不能删除这个分类,还有围栏没删除" : "You can't delete this category. There are still fences");
                            }
                        })
                    },
                    deleteTreeChildren: function(data) {
                        var url = myUrls.delGeoSystemRecord(),
                            me = this;
                        utils.sendAjax(url, {
                            categoryid: data.categoryid,
                            geosystemrecordid: data.geosystemrecordid
                        }, function(resp) {
                            if (resp.status === 0) {
                                me.cancelSelected();
                                me.originalData.forEach(function(item, idx) {
                                    if (item.categoryid === data.categoryid) {
                                        var i = null;
                                        item.children.forEach(function(item, j) {
                                            if (item.geosystemrecordid === data.geosystemrecordid) {
                                                i = j;
                                            }
                                        });
                                        item.children.splice(i, 1);
                                    }
                                });
                            } else {
                                me.$Message.error(isZh ? "删除失败" : "Deletion failed");
                            }
                        })
                    },
                    transformPoint: function(pointList) {
                        var points = [];
                        var iteratior = function(item) {
                            var pointStr = item.split(',')
                            var pointArr = bd09towgs84(Number(pointStr[0].trim()), Number(pointStr[1].trim()));
                            points.push({
                                lon: pointArr[0].toFixed(6),
                                lat: pointArr[1].toFixed(6),
                            })
                        }
                        pointList.forEach(iteratior);
                        return points;
                    },
                    getWgs84Boundaries: function(boundaries) {
                        var pointList = [],
                            me = this;
                        boundaries.forEach(function(item) {
                            var points = me.transformPoint(item.split(";"));
                            pointList = pointList.concat(points);
                        })
                        return pointList;
                    },
                    setMapZoom: function(value) {
                        var zoom = 4;
                        if (value > 90000) {
                            zoom = 5;
                        } else if (value > 90000) {
                            zoom = 6;
                        } else if (value > 70000) {
                            zoom = 7;
                        } else if (value > 50000) {
                            zoom = 8;
                        } else if (value > 40000) {
                            zoom = 9;
                        } else if (value > 30000) {
                            zoom = 10;
                        } else if (value > 20000) {
                            zoom = 11;
                        } else if (value > 10000) {
                            zoom = 12;
                        } else if (value > 5000) {
                            zoom = 13;
                        } else if (value > 1000) {
                            zoom = 14;
                        } else {
                            zoom = 16;
                        };
                        this.map.setZoom(zoom);
                    },
                    drawCircular: function() {
                        this.drawTool.enable();
                        this.cancelSelected();
                        this.isEdit = false;
                        this.isCircular = true;
                        this.isPolygon = false;
                        this.isRoutePlanning = false;
                        this.type = 1;
                        this.radius = 0;
                        this.geoName = "";
                        this.drawTool.setMode('Circle').enable();
                    },
                    drawPolygon: function() {
                        this.type = 2;
                        this.isCircular = false;
                        this.isPolygon = true;
                        this.isEdit = false;
                        this.isRoutePlanning = false;
                        this.geoName = "";
                        this.cancelSelected();
                        this.drawTool.setMode('Polygon').enable();
                    },
                    addRoutePlanningTip: function() {
                        this.type = 5;
                        this.isCircular = false;
                        this.isPolygon = false;
                        this.isEdit = false;
                        this.isRoutePlanning = true;
                        this.geoName = "";
                        this.cancelSelected();
                        this.drawTool.disable();
                    },
                    handleAddPolygon: function() {
                        if (this.selectTypeList.length === 0) {
                            this.$Message.error(isZh ? "请先添加分类" : "Please add classification first");
                            return;
                        }
                        if (this.geoName == "") {
                            this.$Message.error(isZh ? "请填写围栏名称" : "Please fill in the name of the fence");
                            return;
                        }
                        if (!this.classId) {
                            me.$Message.success(isZh ? "请选择类型" : "Please select type")
                            return;
                        }
                        if (this.isCircular) {
                            this.handleSaveCircular();
                        } else {
                            var data = {
                                categoryid: this.classId,
                                points2: JSON.stringify(points2List),
                                type: 2,
                                name: this.geoName,
                            };
                            var url = myUrls.addGeoSystemRecord(),
                                me = this;
                            utils.sendAjax(url, data, function(resp) {
                                if (resp.status === 0 && resp.record) {
                                    me.originalData.forEach(function(item) {
                                        if (data.categoryid === item.categoryid) {
                                            resp.record.title = resp.record.name;
                                            resp.record.categoryid = data.categoryid;
                                            resp.record.render = treeChilrenRender;
                                            item.children.push(resp.record);
                                        }
                                    })
                                    me.$Message.success(isZh ? "添加成功" : "Added successfully");
                                    me.isPolygon = false;
                                    me.addPolygonModal = false;
                                } else {
                                    me.$Message.error(isZh ? "添加失败" : "Add failed");
                                    me.$Message.success(isZh ? "添加成功" : "Added successfully");
                                }
                            });
                        }


                    },
                    filterOriginalData: function(categorys) {
                        var originalData = [];
                        categorys.forEach(function(item) {
                            var treeItem = {
                                title: item.name,
                                categoryid: item.categoryid,
                                children: [],
                                render: treeItemRender
                            };
                            item.records.forEach(function(record) {
                                record.title = record.name;
                                record.render = treeChilrenRender;
                                record.categoryid = item.categoryid,
                                    treeItem.children.push(record);

                            });
                            // treeItem.children.push({
                            //   title:"ssss",
                            // })
                            originalData.push(treeItem);
                        });
                        this.originalData = originalData;
                        this.treeData = originalData;
                    },
                    onCheckChange: function(selecteds) {
                        this.isCircular = false;
                        this.isPolygon = false;
                        this.polygonLayer.clear();
                        var points = [];
                        var me = this;
                        var isBMap = me.mapType == 'bMap';
                        selecteds.forEach(function(element) {
                            if (!element.children) {
                                switch (element.type) {
                                    case 1:
                                        if (isBMap) {
                                            var lon_lat = wgs84tobd09(element.lon1, element.lat1);
                                        } else {
                                            var lon_lat = wgs84togcj02(element.lon1, element.lat1);
                                        }

                                        var point = {
                                            x: lon_lat[0],
                                            y: lon_lat[1]
                                        }
                                        points.push(point);
                                        new maptalks.Circle(point, element.radius1, {
                                            symbol: symbol
                                        }).addTo(me.polygonLayer);
                                        break;
                                    case 2:
                                        var lon_lat_s = [];
                                        if (isBMap) {
                                            lon_lat_s = wgs84sToBdPoints(JSON.parse(element.points2));
                                        } else {
                                            lon_lat_s = wgs84sToGooglePoints(JSON.parse(element.points2));
                                        }
                                        points = points.concat(lon_lat_s);
                                        new maptalks.Polygon(lon_lat_s, {
                                            symbol: symbol
                                        }).addTo(me.polygonLayer);
                                        break;
                                    case 5:

                                        var mapPoints = me.convertWgs84PointsToMapPoints(JSON.parse(element.points2));
                                        points = points.concat(mapPoints);
                                        new maptalks.LineString(
                                            mapPoints, {
                                                symbol: {
                                                    'lineColor': {
                                                        'type': 'linear',
                                                        'colorStops': [
                                                            [0.00, 'red'],
                                                            [1.00, 'red']
                                                        ]
                                                    },
                                                    'lineWidth': 4
                                                }
                                            }).addTo(me.polygonLayer);
                                        var startCoordinate = mapPoints[0];
                                        var endCoordinate = mapPoints[mapPoints.length - 1];
                                        new maptalks.Marker(
                                            [startCoordinate.x, startCoordinate.y], {
                                                symbol: [{
                                                    'markerFile': './images/map/marker_qidian.png',
                                                    'markerWidth': 30,
                                                    'markerHeight': 30,
                                                    'markerRotation': 0,
                                                    'markerDy': 0,
                                                    'markerDx': 0,
                                                }, {
                                                    'textFaceName': 'sans-serif',
                                                    'textName': '起点',
                                                    'textSize': 12,
                                                    'textDy': 10,
                                                    'textFill': '#ffffff',
                                                    'textOpacity': 1,
                                                    'textHaloFill': '#00A8D4',
                                                    'textHaloRadius': 5,
                                                    'textWrapWidth': null,
                                                    'textWrapCharacter': '\n',
                                                    'textLineSpacing': 0,
                                                }]

                                            }
                                        ).addTo(me.polygonLayer);
                                        var totalDistance = element.totaldistance5;
                                        var totalDuration = element.totalduration5;
                                        new maptalks.Marker(
                                            [endCoordinate.x, endCoordinate.y], {
                                                symbol: [{
                                                    'markerFile': './images/map/marker_zhongdian.png',
                                                    'markerWidth': 30,
                                                    'markerHeight': 30,
                                                    'markerRotation': 0,
                                                    'markerDy': 0,
                                                    'markerDx': 0,
                                                }, {
                                                    'textFaceName': 'sans-serif',
                                                    'textName': '总里程:' + (totalDistance / 1000).toFixed(2) + '公里,时长:' + me.timeStamp(totalDuration * 1000),
                                                    'textSize': 12,
                                                    'textDy': 10,
                                                    'textFill': '#ffffff',
                                                    'textOpacity': 1,
                                                    'textHaloFill': '#00A8D4',
                                                    'textHaloRadius': 5,
                                                    'textWrapWidth': null,
                                                    'textWrapCharacter': '\n',
                                                    'textLineSpacing': 0,
                                                }]
                                            }
                                        ).addTo(me.polygonLayer);
                                        break;
                                }

                            }
                        });
                        this.setViewPortCenter(points);
                    },
                    cancelSelected: function() {
                        this.polygonLayer.clear();
                        this.originalData.forEach(function(item) {
                            item.checked = false;
                            item.children.forEach(function(record) {
                                record.checked = false;
                            });
                        });
                        this.treeData.forEach(function(item) {
                            item.checked = false;
                            item.children.forEach(function(record) {
                                record.checked = false;
                            });
                        });
                    },
                    handleSaveCircular: function() {
                        var me = this;
                        var url = myUrls.addGeoSystemRecord();
                        var data = {
                            categoryid: this.classId,
                            type: 1,
                            lat1: points1List[1],
                            lon1: points1List[0],
                            radius1: Number(parseInt(this.radius)),
                            name: this.geoName
                        };
                        utils.sendAjax(url, data, function(resp) {
                            if (resp.status === 0) {
                                me.originalData.forEach(function(item) {
                                    if (data.categoryid === item.categoryid) {
                                        resp.record.title = resp.record.name;
                                        resp.record.categoryid = data.categoryid;
                                        resp.record.render = treeChilrenRender;
                                        item.children.push(resp.record);
                                    }
                                })
                                if (me.originalData !== me.treeData) {
                                    me.treeData.forEach(function(item) {
                                        if (data.categoryid === item.categoryid) {
                                            resp.record.title = resp.record.name;
                                            resp.record.categoryid = data.categoryid;
                                            resp.record.render = treeChilrenRender;
                                            item.children.push(resp.record);
                                        }
                                    })
                                }
                                me.$Message.success(isZh ? "添加成功" : "Added successfully");
                                me.addPolygonModal = false;
                            } else {
                                me.$Message.error(isZh ? "添加失败" : "Add failed");
                            }
                        });
                    },
                    _queryGeoSystemRecords: function() {
                        var url = myUrls.queryGeoSystemRecords(),
                            me = this;
                        utils.sendAjax(url, {}, function(resp) {
                            if (resp.status == 0) {
                                if (resp.categorys) {
                                    me.filterOriginalData(resp.categorys);
                                }
                            }
                        })
                    }
                },
                computed: {
                    selectTypeList: function() {
                        var typeList = [];
                        this.originalData.forEach(function(item) {
                            typeList.push({
                                label: item.title,
                                value: item.categoryid
                            });
                        });
                        return typeList;
                    }
                },
                watch: {
                    searchValue: function(newValue) {
                        this.searchChange(this, newValue);
                    },
                    addPolygonModal: function(val) {
                        if (!val) {
                            this.polygonLayer.clear();
                            this.isCircular = false;
                            this.isPolygon = false;
                        }
                    },
                    mapType: function(newVal, oldVal) {
                        var geometries = this.polygonLayer.getGeometries();
                        geometries.forEach(function(geometrie) {
                            var points = geometrie.getCoordinates();
                            if (points instanceof Array) {
                                var newPoints = [];
                                points.forEach(function(items) {
                                    var newItems = [];
                                    if (items.forEach) {
                                        items.forEach(function(point) {
                                            var newPoint = null;
                                            if (newVal == 'bMap') {
                                                var lon_lat = gcj02tobd09(point.x, point.y);
                                                newPoint = {
                                                    x: lon_lat[0],
                                                    y: lon_lat[1]
                                                };
                                            } else if (newVal == 'gMap') {
                                                if (oldVal == 'aMap' || oldVal == "gMap" || oldVal == "gChinaMap") {
                                                    newPoint = point;
                                                } else {
                                                    var lon_lat = bd09togcj02(point.x, point.y);
                                                    var newPoint = {
                                                        x: lon_lat[0],
                                                        y: lon_lat[1]
                                                    };
                                                }


                                            }

                                            newItems.push(newPoint);
                                        })
                                        newPoints.push(newItems);
                                    } else {
                                        var newPoint = null;
                                        if (newVal == 'bMap') {
                                            var lon_lat = gcj02tobd09(items.x, items.y);
                                            newPoint = {
                                                x: lon_lat[0],
                                                y: lon_lat[1]
                                            };
                                        } else if (newVal == 'gMap') {


                                            if (oldVal == 'aMap' || oldVal == "gMap" || oldVal == "gChinaMap") {
                                                newPoint = items;
                                            } else {
                                                var lon_lat = bd09togcj02(items.x, items.y);
                                                newPoint = {
                                                    x: lon_lat[0],
                                                    y: lon_lat[1]
                                                };
                                            }
                                        }
                                        newPoints.push(newPoint);
                                    }
                                });
                                geometrie.setCoordinates(newPoints);
                            } else {
                                var newPoint = null;
                                if (newVal == 'bMap') {
                                    var lon_lat = gcj02tobd09(points.x, points.y);
                                    newPoint = {
                                        x: lon_lat[0],
                                        y: lon_lat[1]
                                    };
                                } else if (newVal == 'gMap') {
                                    if (oldVal == 'aMap' || oldVal == "gMap" || oldVal == "gChinaMap") {
                                        newPoint = points;
                                    } else {
                                        var lon_lat = bd09togcj02(points.x, points.y);
                                        newPoint = {
                                            x: lon_lat[0],
                                            y: lon_lat[1]
                                        };
                                    }
                                }

                                geometrie.setCoordinates(newPoint);
                            }
                        })
                    }
                },
                mounted: function() {
                    this.initMap();
                    this._queryGeoSystemRecords();
                }
            });
        })();
    </script>
</body>

</html>